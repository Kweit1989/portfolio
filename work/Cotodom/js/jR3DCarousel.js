(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)}else{if(typeof exports==="object"){module.exports=a(require("jquery"))}else{a(jQuery)}}})(function(a){a.fn.jR3DCarousel=function(y){var f={width:innerWidth,height:innerHeight,slides:[],slideLayout:"fill",perspective:0,animation:"slide3D",animationCurve:"ease",animationDuration:700,animationInterval:10000,autoplay:true,controls:true,slideClass:"jR3DCarouselSlide",navigation:"circles",rotationDirection:"rtl",onSlideShow:function(){}};var s=a.extend(true,{},f,y);var u=this;var d=s.width;var m=s.height;var G=s.width/s.height;var N=a("<div class='jR3DCarousel' />").css({width:"100%",height:"100%",transition:"transform "+s.animationDuration+"ms "+s.animationCurve,transformStyle:"preserve-3d"}).appendTo(u);var M=0;var o=1;var v=new p();var b;var L;var C;var E;var D=0;var n;var K;var l;var H=s.slides.length||u.find("."+s.slideClass).length;(function h(){S();if(s.controls){Q()}if(s.navigation){P()}addEventListener("resize",z);z();if(s.autoplay){document.addEventListener("visibilitychange",R);addEventListener("beforeunload",function(){document.removeEventListener("visibilitychange",R)});function R(){if(document.hidden){t()}else{g()}}u.hover(function(){clearTimeout(a(this).data("timeout"));t()},function(){a(this).data("timeout",setTimeout(function(){g()},s.animationInterval+s.animationDuration))});g()}function S(){if(s.animation.indexOf("slide")!=-1){n=(d/2)/Math.tan(Math.PI/H);K=(d/2)*Math.tan(2*Math.PI/H)+"px"}else{if(s.animation.indexOf("scroll")!=-1){n=(m/2)/Math.tan(Math.PI/H);K=(m/2)*Math.tan(2*Math.PI/H)+"px"}else{if(s.animation=="fade"){n=(d/2)/Math.tan(Math.PI/H);K=(d/2)*Math.tan(2*Math.PI/H)+"px"}}}E=360/H;if(s.slides.length){for(var U=0;U<s.slides.length;U++){var T=a("<div class='jR3DCarouselSlide' data-index="+U+" />").append("<img src='"+s.slides[U].src+"' alt='"+s.slides[U].alt+"' />");if(s.animation.indexOf("slide")!=-1){l="rotateY("+E*U+"deg) translateZ("+n+"px)"}else{if(s.animation.indexOf("scroll")!=-1){l="rotateX("+E*U+"deg) translateZ("+n+"px)"}else{if(s.animation=="fade"){l="rotateY("+E*U+"deg) translateZ("+n+"px)"}}}T.css({transform:l});N.append(T)}}else{u.find("."+s.slideClass).each(function(W){var V=a(this).attr("data-index",W);if(s.animation.indexOf("slide")!=-1){l="rotateY("+E*W+"deg) translateZ("+n+"px)"}else{if(s.animation.indexOf("scroll")!=-1){l="rotateX("+E*W+"deg) translateZ("+n+"px)"}else{if(s.animation=="fade"){l="rotateY("+E*W+"deg) translateZ("+n+"px)"}}}V=V.css({transform:l}).detach();N.append(V)})}N.find("."+s.slideClass).css({position:"absolute",left:0,top:0,width:"100%",height:"100%",backfaceVisibility:"hidden"}).find("img").css({width:"100%",height:"100%",objectFit:s.slideLayout});K=s.perspective||K;u.css({perspective:K,width:d+"px",height:m+"px",position:"relative",overflow:"visible"})}function Q(){if(s.rotationDirection=="rtl"){b=a("<div class='previous controls' style='left: 0.1em;'>&lang;</div>");L=a("<div class='next controls' style='right: 0.1em;'>&rang;</div>")}else{b=a("<div class='previous controls' style='right: 0.1em;'>&rang;</div>");L=a("<div class='next controls' style='left: 0.1em;'>&lang;</div>")}b.add(L).css({position:"absolute",top:"50%",zIndex:1,transform:"translateY(-50%)",fontSize:"4em",color:"rgba(255, 255, 255, 0.97)",cursor:"pointer",userSelect:"none"}).appendTo(u).hide();b.on("click",function(){j()});L.on("click",function(){B()});u.on("mouseenter touchstart",function(){b.add(L).show()}).on("mouseleave touchcancel",function(){b.add(L).hide()});b.hover(function(){b.css({color:"rgba(201, 201, 201, 0.97)"})},function(){b.css({color:"rgba(255, 255, 255, 0.97)"})});L.hover(function(){L.css({color:"rgba(201, 201, 201, 0.97)"})},function(){L.css({color:"rgba(255, 255, 255, 0.97)"})});a(document).on("keydown",function(V){var U=u[0].getBoundingClientRect();var T=U.bottom>0&&U.right>0&&U.left<(innerWidth||document.documentElement.clientWidth)&&U.top<(innerHeight||document.documentElement.clientHeight);if(T&&V.which==37){t();if(s.rotationDirection=="rtl"){b.click()}else{L.click()}}else{if(T&&V.which==39){t();if(s.rotationDirection=="rtl"){L.click()}else{b.click()}}}});k(u,function(T){t();if(T=="left"){L.click()}else{if(T=="right"){b.click()}else{if(s.animation.indexOf("scroll")!=-1){if(T=="down"){L.click()}else{if(T=="up"){b.click()}}}}}})}function P(){var U=a("<div class=navigation />").css({position:"absolute",bottom:0,right:0});for(var T=0;T<H;T++){U.append("<div class=nav></div>")}if(s.navigation=="circles"){U.find(".nav").css({borderRadius:"12px"})}U.find(".nav").css({display:"inline-block",margin:"5px",cursor:"pointer",backgroundColor:"rgba(255, 255, 255, 0.77)",width:"12px",height:"12px",transition:"all "+s.animationDuration+"ms ease"}).first().css({backgroundColor:"rgba(0, 0, 0, 1)"});N.after(U);u.on("click",".nav",function(){q(a(this).index())})}})();function g(){t();C=setInterval(B,s.animationInterval+s.animationDuration)}function t(){if(C){clearInterval(C)}}function B(){o=M+1;v.run(s.animation,o);J()}function j(){o=M-1;v.run(s.animation,o);J()}function q(P){var Q=Math.floor(M/H);o=Q*H+P;v.run(s.animation,o);J()}function i(){return N.find("."+s.slideClass).eq((M-1)%H)}function A(){return N.find("."+s.slideClass).eq(M%H)}function r(){return N.find("."+s.slideClass).eq((M+1)%H)}function w(P){return N.find("."+s.slideClass+"[data-index="+P+"]")}function p(){this.animations={slide:c,slide3D:I,scroll:e,scroll3D:F,fade:O}}p.prototype.run=function x(Q,P){this.animations[Q](P)};function c(P){u.css({perspective:"",overflow:"hidden"});D=E*P;N.css({transform:"translateZ("+-n+"px) rotateY("+-D+"deg)"})}function I(P){u.css({perspective:K,overflow:"visible"});D=E*P;N.css({transform:"translateZ("+-n+"px) rotateY("+-D+"deg)"})}function e(P){u.css({perspective:"",overflow:"hidden"});D=E*P;N.css({transform:"translateZ("+-n+"px) rotateX("+-D+"deg)"})}function F(P){u.css({perspective:K,overflow:"visible"});D=E*P;N.css({transform:"translateZ("+-n+"px) rotateX("+-D+"deg)"})}function O(P){N.css({transition:"opacity "+s.animationDuration+"ms "+s.animationCurve,opacity:0});D=E*P;N.css({transform:"translateZ("+-n+"px) rotateY("+-D+"deg)"});N.css({opacity:1})}function J(){u.find(".nav").css({backgroundColor:"rgba(255, 255, 255, 0.77)"}).eq(o%H).css({backgroundColor:"rgba(0, 0, 0, 0.77)"});M=Math.round(D/E);s.onSlideShow.call(this,A())}function z(){u.width("100%");N.hide();d=u.width()<s.width?u.width():s.width;m=d/G;u.css({width:d+"px",height:m+"px"});if(s.animation.indexOf("slide")!=-1){n=(d/2)/Math.tan(Math.PI/H);K=(d/2)*Math.tan(2*Math.PI/H)+"px"}else{if(s.animation.indexOf("scroll")!=-1){n=(m/2)/Math.tan(Math.PI/H);K=(m/2)*Math.tan(2*Math.PI/H)+"px"}else{if(s.animation=="fade"){n=(d/2)/Math.tan(Math.PI/H);K=(d/2)*Math.tan(2*Math.PI/H)+"px"}}}u.find("."+s.slideClass).each(function(Q){var P=a(this);if(s.animation.indexOf("slide")!=-1){l="rotateY("+E*Q+"deg) translateZ("+n+"px)"}else{if(s.animation.indexOf("scroll")!=-1){l="rotateX("+E*Q+"deg) translateZ("+n+"px)"}else{if(s.animation=="fade"){l="rotateY("+E*Q+"deg) translateZ("+n+"px)"}}}P.css({transform:l})});K=s.perspective||K;N.css({transform:"translateZ("+-n+"px) rotateY("+-D+"deg)"});N.show();u.css({perspective:K})}function k(R,T){var aa=R,S,W,U,Z,Y,V=20,X=100,Q=700,ab,P;aa.on("touchstart",function(ad){var ac=ad.originalEvent.changedTouches[0];S="none";W=ac.pageX;U=ac.pageY;P=new Date().getTime()}).on("touchmove",function(ac){ac.preventDefault()}).on("touchend",function(ad){var ac=ad.originalEvent.changedTouches[0];Z=ac.pageX-W;Y=ac.pageY-U;ab=new Date().getTime()-P;if(ab<=Q){if(Math.abs(Z)>=V&&Math.abs(Y)<=X){S=(Z<0)?"left":"right"}else{if(Math.abs(Y)>=V&&Math.abs(Z)<=X){S=(Y<0)?"up":"down"}}}T(S)})}this.showSlide=function(Q){var P=Q%H;q(P)};this.getCurrentSlide=function(){return A()};this.getSlideByIndex=function(P){return w(P)};this.showPreviousSlide=function(){b.click()};this.showNextSlide=function(){L.click()};this.playCarousel=function(){g()};this.pauseCarousel=function(){t()};return this}});